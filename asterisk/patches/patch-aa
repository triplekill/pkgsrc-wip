$NetBSD$

--- Makefile.orig	2003-03-18 15:00:13.000000000 +0900
+++ Makefile	2003-08-24 09:39:13.000000000 +0900
@@ -43,16 +43,16 @@
 # Default -> leave empty
 INSTALL_PREFIX=
 
-ASTLIBDIR=$(INSTALL_PREFIX)/usr/lib/asterisk
-ASTVARLIBDIR=$(INSTALL_PREFIX)/var/lib/asterisk
-ASTETCDIR=$(INSTALL_PREFIX)/etc/asterisk
-ASTSPOOLDIR=$(INSTALL_PREFIX)/var/spool/asterisk
-ASTLOGDIR=$(INSTALL_PREFIX)/var/log/asterisk
-ASTHEADERDIR=$(INSTALL_PREFIX)/usr/include/asterisk
+ASTLIBDIR=$(PREFIX)/lib/asterisk
+ASTVARLIBDIR=$(PREFIX)/lib/asterisk/var
+ASTETCDIR=$(PKG_SYSCONFDIR)/asterisk
+ASTSPOOLDIR=/var/spool/asterisk
+ASTLOGDIR=/var/log/asterisk
+ASTHEADERDIR=$(PREFIX)/include/asterisk
 ASTCONFPATH=$(ASTETCDIR)/asterisk.conf
-ASTBINDIR=$(INSTALL_PREFIX)/usr/bin
-ASTSBINDIR=$(INSTALL_PREFIX)/usr/sbin
-ASTVARRUNDIR=$(INSTALL_PREFIX)/var/run
+ASTBINDIR=$(PREFIX)/bin
+ASTSBINDIR=$(PREFIX)/sbin
+ASTVARRUNDIR=/var/run
 
 
 MODULES_DIR=$(ASTLIBDIR)/modules
@@ -85,7 +85,7 @@
 CFLAGS+= $(TRACE_FRAMES)
 CFLAGS+=# -fomit-frame-pointer 
 SUBDIRS=res channels pbx apps codecs formats agi cdr astman
-LIBS=-ldl -lpthread -lncurses -lm  #-lnjamd
+LIBS=-lpthread -lm #-lncurses -lnjamd
 OBJS=io.o sched.o logger.o frame.o loader.o config.o channel.o \
 	translate.o file.o say.o pbx.o cli.o md5.o term.o \
 	ulaw.o alaw.o callerid.o fskmodem.o image.o app.o \
@@ -114,11 +114,11 @@
 	fi
 
 editline/libedit.a: editline/config.h
-	make -C editline libedit.a
+	${MAKE} -C editline libedit.a
 
 db1-ast/libdb1.a: 
 	@if [ -d db1-ast ]; then \
-		make -C db1-ast libdb1.a ; \
+		${MAKE} -C db1-ast libdb1.a ; \
 	else \
 		echo "You need to do a cvs update -d not just cvs update"; \
 		exit 1; \
@@ -148,8 +148,8 @@
 	rm -f *.o *.so asterisk
 	rm -f build.h 
 	rm -f ast_expr.c
-	@if [ -e editline/Makefile ]; then make -C editline clean ; fi
-	make -C db1-ast clean
+	@if [ -e editline/Makefile ]; then ${MAKE} -C editline clean ; fi
+	${MAKE} -C db1-ast clean
 
 datafiles: all
 	mkdir -p $(ASTVARLIBDIR)/sounds/digits
@@ -305,8 +305,8 @@
 __rpm: _version
 	rm -rf /tmp/asterisk ; \
 	mkdir -p /tmp/asterisk/redhat/RPMS/i386 ; \
-	make INSTALL_PREFIX=/tmp/asterisk install ; \
-	make INSTALL_PREFIX=/tmp/asterisk samples ; \
+	${MAKE} INSTALL_PREFIX=/tmp/asterisk install ; \
+	${MAKE} INSTALL_PREFIX=/tmp/asterisk samples ; \
 	mkdir -p /tmp/asterisk/etc/rc.d/init.d ; \
 	cp -f redhat/asterisk /tmp/asterisk/etc/rc.d/init.d/ ; \
 	cp -f redhat/rpmrc /tmp/asterisk/ ; \
@@ -329,6 +329,6 @@
 
 	
 dont-optimize:
-	make OPTIMIZE= K6OPT= install
+	${MAKE} OPTIMIZE= K6OPT= install
 
 valgrind: dont-optimize
