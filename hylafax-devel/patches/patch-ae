$NetBSD: patch-ae,v 1.10 2005/01/27 16:22:37 adam Exp $

--- configure.orig	2004-12-28 04:45:03.000000000 +0000
+++ configure
@@ -37,23 +37,23 @@
 #
 # Setup general configuration parameters.
 #
-DIR_BIN=/usr/local/bin
-DIR_SBIN=/usr/local/sbin
-DIR_LIBDATA=/usr/local/lib/fax
-DIR_LIB=/usr/local/lib
-DIR_LIBEXEC=$DIR_SBIN
+DIR_BIN=${PREFIX}/bin
+DIR_SBIN=${PREFIX}/sbin
+DIR_LIBDATA=${PREFIX}/libdata/hylafax
+DIR_LIB=${PREFIX}/lib
+DIR_LIBEXEC=${PREFIX}/libexec
 DIR_SPOOL=/var/spool/hylafax
-DIR_HTML=/var/httpd/htdocs/hylafax
-DIR_CGI=/var/httpd/cgi-bin
+DIR_HTML=${PREFIX}/http/htdocs/hylafax
+DIR_CGI=${PREFIX}/http/cgi-bin
 PATH_DPSRIP=$DIR_LIBEXEC/ps2fax.exe
-PATH_IMPRIP=/usr/lib/print/psrip
+PATH_IMPRIP=${PREFIX}/lib/print/psrip
 HTMLPATH=/hylafax
 CGIPATH=/cgi-bin
 DEFVRES=98
 PAGESIZE="North American Letter"
 FAXUID=uucp
 FAXGID=
-SYSUID=bin
+SYSUID=root
 SYSGID=
 DSO=auto
 GETTY=auto
@@ -72,9 +72,8 @@ DPS=no
 GS=no
 IMP=no
 UTMP=auto
-OPTIMIZER="-O"
-LIBTIFF="-L/usr/local/lib -ltiff"
-TIFFINC=/usr/local/include
+LIBTIFF="-Wl,-R${PREFIX}/lib -L${PREFIX}/lib -ltiff -ljpeg -lz -lm"
+TIFFINC=${PREFIX}/include
 TIFFBIN=
 LIBZ=
 ZLIBINC=
@@ -82,8 +81,8 @@ REGEX=yes
 LIBREGEX='-L${DEPTH}/regex -lregex'
 REGEXINC='${DEPTH}/${TOPSRCDIR}/regex'
 DBLIB=no
-LIBDB="-L/usr/local/lib -ldb"
-DBLIBINC=/usr/local/include
+LIBDB="-L${PREFIX}/lib -ldb"
+DBLIBINC=${PREFIX}/include
 FAXD=
 LIBFAXSERVER='libfaxserver.${DSO}'
 LIBUTIL='${UTIL}/libfaxutil.${DSO}'
@@ -222,6 +221,7 @@ PKG_EMAIL
 PKG_VENDOR
 PORT
 PORTFUNCS
+PREFIX
 PROTOTYPES
 PSPACKAGE	PS
 PWDCMD
@@ -287,7 +287,7 @@ test -d /usr/bsd && PATH=$PATH:/usr/bsd	
 test -d /usr/ucb && PATH=$PATH:/usr/ucb			# Sun and others
 test -d /usr/contrib/bin && PATH=$PATH:/usr/contrib/bin	# BSDi
 test -d /usr/5bin && PATH=/usr/5bin:$PATH:/usr/etc	# Sun and others
-test -d /usr/local/bin && PATH=/usr/local/bin:$PATH	# for GNU stuff
+test -d ${PREFIX}/bin && PATH=${PREFIX}/bin:$PATH	# for packages stuff
 PATH=$PATH:$OPATH
 
 POSIXLY_CORRECT=1; export POSIXLY_CORRECT		# disable GNU extensions
@@ -3086,13 +3086,7 @@ main()
         printf("old include files: version %u\n", ZLIB_VERSION);
         exit(-1);
     }
-    if (strncmp(zlib_version, ZLIB_VERSION, 4) != 0) {
-        printf("library/header file incompatibility: %s %s\n",
-        zlib_version, ZLIB_VERSION);
-        exit(-1);
-    } else {
         exit(0);
-    }
 }
 EOF
 capture cat t.c
@@ -3154,7 +3148,7 @@ Note "Checking TIFF support."
 # Location of TIFF binaries
 #
 if [ -z "$TIFFBIN" ]; then
-    DIRS="/usr/local/bin /usr/contrib/bin /usr/gnu/bin /usr/bin"
+    DIRS="${PREFIX}/bin /usr/local/bin /usr/gnu/bin /usr/bin"
     for i in $DIRS; do
         test -x $i/tiff2ps && { TIFFBIN=$i; break; }
     done
@@ -3775,7 +3769,7 @@ fi
 if [ -z "$PATH_VGETTY" ]; then
     PATH_VGETTY=`findApp vgetty /usr/libexec:/sbin:$PATH` 
     if [ -z "$PATH_VGETTY" ]; then
-	PATH_VGETTY=/bin/vgetty
+	PATH_VGETTY=${PREFIX}/bin/vgetty
 	Note "WARNING, no vgetty program found to handle a voice call, using $PATH_VGETTY."
     else
 	Note "Looks like $PATH_VGETTY is the program to exec for a voice call."
@@ -3788,7 +3782,7 @@ fi
 if [ -z "$PATH_EGETTY" ]; then
     PATH_EGETTY=`findApp egetty /usr/libexec:/sbin:$PATH` 
     if [ -z "$PATH_EGETTY" ]; then
-	PATH_EGETTY=/bin/egetty
+	PATH_EGETTY=${PREFIX}/bin/egetty
 	Note "WARNING, no egetty program found, using $PATH_EGETTY."
     else
 	Note "Looks like $PATH_EGETTY is the program to exec for an extern call."
@@ -3859,6 +3853,7 @@ PickRIP()
 {
     if [ -z "$PATH_GSRIP" ]; then
 	GSLOCS="
+	    ${PREFIX}/bin/gs
 	    /usr/local/bin/gs
 	    /usr/contrib/bin/gs
 	    /usr/gnu/bin/gs
@@ -3906,7 +3901,7 @@ fax software to operate correctly.  See 
 on building Ghostscript with the necessary TIFF driver.
 
 EOF
-	PATH_PSRIP=/usr/local/bin/gs
+	PATH_PSRIP=${PREFIX}/bin/gs
 	PATH_GSRIP=$PATH_PSRIP
     fi
 }
@@ -3973,9 +3968,9 @@ if [ -z "$PATH_AFM" ]; then
     else
         DIR_AFMS="
 	    /usr/lib/afm
-	    /usr/local/lib/afm
-	    /usr/local/share/ghostscript/fonts
-	    /usr/local/lib/ghostscript/fonts
+	    ${PREFIX}/lib/afm
+	    ${PREFIX}/share/ghostscript/fonts
+	    ${PREFIX}/lib/ghostscript/fonts
 	    /usr/share/ghostscript/fonts
 	    /usr/gnu/lib/ghostscript/fonts
 	    /opt/gnu/lib/ghostscript/fonts
@@ -3995,7 +3990,7 @@ if [ -z "$PATH_AFM" ]; then
 fi
 if [ -z "$PATH_AFM" ]; then
     # put it where ghostscript normally puts things
-    PATH_AFM=/usr/local/lib/ghostscript/fonts
+    PATH_AFM=${PREFIX}/share/ghostscript/fonts
     Note "WARNING, could not locate a directory with font metric information,"
     Note "guessing that font metric information goes in $PATH_AFM."
 else
@@ -4014,6 +4009,7 @@ fi
 #
 if [ -z "$DIR_MAN" ]; then
     MANPATH="
+	${PREFIX}/man
 	$MANPATH
 	/usr/local/man
 	/usr/contrib/man
@@ -4023,7 +4019,7 @@ if [ -z "$DIR_MAN" ]; then
     for i in $MANPATH; do
 	test -d $i && { DIR_MAN=$i; break; }
     done
-    test -z "$DIR_MAN" && DIR_MAN=/usr/local/man
+    test -z "$DIR_MAN" && DIR_MAN=${PREFIX}/man
 fi
 Note "Looks like manual pages go in $DIR_MAN."
 if [ -z "$MANSCHEME" ]; then
