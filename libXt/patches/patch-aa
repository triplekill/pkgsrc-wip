$NetBSD$

--- Xtos.h.orig	2004-01-30 19:01:25.000000000 -0800
+++ Xtos.h
@@ -52,11 +52,27 @@ SOFTWARE.
 
 #ifndef _Xtos_h
 #define _Xtos_h
-
-#define ALLOCATE_LOCAL_FALLBACK(_size) XtMalloc((unsigned long)(_size))
-#define DEALLOCATE_LOCAL_FALLBACK(_ptr) XtFree((XtPointer)(_ptr))
-#include <X11/Xalloca.h>
-
+ 
+#if HAVE_ALLOCA
+/* AIX requires this to be the first thing in the file.  */
+# if HAVE_ALLOCA_H 
+#   include <alloca.h>
+# else
+#  ifdef _AIX
+ #pragma alloca
+#  else
+#   ifndef alloca /* predefined by HP cc +Olibcalls */
+char *alloca ();
+#   endif
+#  endif
+# endif
+#define ALLOCATE_LOCAL(size) alloca((int)(size))
+#define DEALLOCATE_LOCAL(ptr) /* as nothing */
+#else
+#define ALLOCATE_LOCAL(_size) XtMalloc((unsigned long)(_size))
+#define DEALLOCATE_LOCAL(_ptr) XtFree((XtPointer)(_ptr))
+#endif
+ 
 #ifdef CRAY
 #define WORD64
 #endif
