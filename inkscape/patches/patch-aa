$NetBSD$

--- src/extension/internal/ps.cpp.orig	2004-06-20 22:49:24.000000000 -0700
+++ src/extension/internal/ps.cpp
@@ -52,6 +52,7 @@
 #include "document.h"
 #include "inkscape.h"
 #include "style.h"
+#include "inkscape_version.h"
 
 #include "ps.h"
 #include <extension/system.h>
@@ -321,6 +322,7 @@ PrintPS::begin (Inkscape::Extension::Pri
 
 	NRRect d;
 	bool   pageBoundingBox;
+	bool   pageLandscape;
 	mod->get_param("pageBoundingBox", &pageBoundingBox);
 	// printf("Page Bounding Box: %s\n", pageBoundingBox ? "TRUE" : "FALSE");
 	if (pageBoundingBox)
@@ -336,20 +338,38 @@ PrintPS::begin (Inkscape::Extension::Pri
 	}
 
 	if (res >= 0) {
-		os << "%%BoundingBox: " << (int) d.x0 << " "
-					<< (int) d.y0 << " "
-					<< (int) ceil (d.x1) << " "
-					<< (int) ceil (d.y1) << "\n";
-	}
-	if (res >= 0) {
-		os << "%%HiResBoundingBox: " << d.x0 << " "
-					<< d.y0 << " "
-					<< d.x1 << " "
-					<< d.y1 << "\n";
+
+		os << "%%Creator: Inkscape " << INKSCAPE_VERSION << "\n";
+		
+		pageLandscape = (d.x1 > d.y1) ? true : false;
+
+		if (pageLandscape) {
+			os << "%%Orientation: Landscape\n";
+			os << "%%BoundingBox: " << (int) d.x0 << " "
+						<< (int) d.y0 << " "
+						<< (int) ceil (d.y1) << " "
+						<< (int) ceil (d.x1) << "\n";
+			os << "%%HiResBoundingBox: " << d.x0 << " "
+						<< d.y0 << " "
+						<< d.y1 << " "
+						<< d.x1 << "\n";
+			os << 90 << " rotate\n";
+		}
+		else
+		{
+			os << "%%BoundingBox: " << (int) d.x0 << " "
+						<< (int) d.y0 << " "
+						<< (int) ceil (d.x1) << " "
+						<< (int) ceil (d.y1) << "\n";
+			os << "%%HiResBoundingBox: " << d.x0 << " "
+						<< d.y0 << " "
+						<< d.x1 << " "
+						<< d.y1 << "\n";
+			os << "0.0 " << sp_document_height (doc) << " translate\n";
+		}
+		os << "0.8 -0.8 scale\n";
 	}
 
-	os << "0.0 " << sp_document_height (doc) << " translate\n";
-	os << "0.8 -0.8 scale\n";
 
 	return fprintf (_stream, "%s", os.str().c_str());
 }
