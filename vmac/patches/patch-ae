$NetBSD$

--- gemulator.c.orig	1999-04-27 08:04:38.000000000 +0300
+++ gemulator.c
@@ -11,11 +11,13 @@
 #define SLOW_IO
 
 #include <stdio.h>
-#include <asm/io.h>
 #include <unistd.h>
 #include <errno.h>
 #include <string.h>
-#include <sys/io.h>
+#if defined(__GLIBC__) && __GLIBC__ >= 2
+#  include <asm/io.h>
+#  include <sys/io.h>
+#endif
 
 /* Define TEST to make a linkable ROM dumper */
 #ifdef TEST
@@ -55,6 +57,7 @@ unsigned char bigbuf[cbSocket*countSocke
 
 int Gemulator_LoadROM(UBYTE * NewROM, UWORD Base, UBYTE Socket, UBYTE Length)
 {
+#if defined(__GLIBC__) && __GLIBC__ >= 2
 	int i;
 	int rgsize[countSocket];
 
@@ -110,6 +113,10 @@ int Gemulator_LoadROM(UBYTE * NewROM, UW
 	memcpy(NewROM, bigbuf, 1024 * rgsize[Socket] * Length);
 
 	return(1024 * rgsize[Socket] * Length); //Return size
+#else
+	fprintf(stderr, "Sorry, Gemulator ROM Board is not supported yet in this package.\n");
+	return(0);
+#endif
 }
 
 #ifdef TEST
