Only tested on Solaris. Please test under other OSs and report/fix whatever's broken.
