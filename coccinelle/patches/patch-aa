$NetBSD$

--- Makefile.orig	2009-03-20 18:15:41.000000000 +0000
+++ Makefile
@@ -207,12 +207,19 @@ install-common:
 	mkdir -p $(DESTDIR)$(LIBDIR)
 	mkdir -p $(DESTDIR)$(SHAREDIR)
 	mkdir -p $(DESTDIR)$(MANDIR)/man1
-	cp standard.h $(DESTDIR)$(SHAREDIR)
-	cp standard.iso $(DESTDIR)$(SHAREDIR)
-	cp docs/spatch.1 $(DESTDIR)$(MANDIR)/man1/
+	${BSD_INSTALL_DATA} standard.h $(DESTDIR)$(SHAREDIR)
+	${BSD_INSTALL_DATA} standard.iso $(DESTDIR)$(SHAREDIR)
+	${BSD_INSTALL_DATA} docs/spatch.1 $(DESTDIR)$(MANDIR)/man1/
 	mkdir -p $(DESTDIR)$(SHAREDIR)/python
-	cp -a python/coccilib $(DESTDIR)$(SHAREDIR)/python
-	cp -f dllpycaml_stubs.so $(DESTDIR)$(LIBDIR)
+	mkdir -p $(DESTDIR)$(SHAREDIR)/python/coccilib
+	${BSD_INSTALL_DATA} python/coccilib/Makefile \
+		$(DESTDIR)$(SHAREDIR)/python/coccilib
+	${BSD_INSTALL_DATA} python/coccilib/*.* \
+		$(DESTDIR)$(SHAREDIR)/python/coccilib
+	mkdir -p $(DESTDIR)$(SHAREDIR)/python/coccilib/coccigui
+	${BSD_INSTALL_DATA} python/coccilib/coccigui/* \
+		$(DESTDIR)$(SHAREDIR)/python/coccilib/coccigui
+	${BSD_INSTALL_LIB} dllpycaml_stubs.so $(DESTDIR)$(LIBDIR)
 	@echo ""
 	@echo "You can also install spatch by copying the program spatch"
 	@echo "(available in this directory) anywhere you want and"
@@ -221,17 +228,18 @@ install-common:
 
 # user will use spatch to run spatch.opt (native)
 install: all.opt install-common
-	cp spatch.opt $(DESTDIR)$(SHAREDIR)
-	cat scripts/spatch.sh | sed "s|SHAREDIR|$(DESTDIR)$(SHAREDIR)|g" > $(DESTDIR)$(BINDIR)/spatch
+	${BSD_INSTALL_PROGRAM} spatch.opt $(DESTDIR)$(SHAREDIR)
+	cat scripts/spatch.sh | sed "s|SHAREDIR|$(SHAREDIR)|g" > $(DESTDIR)$(BINDIR)/spatch
+	chmod 555 $(DESTDIR)$(BINDIR)/spatch
 
 # user will use spatch to run spatch (bytecode)
 install-byte: all install-common
-	cp spatch $(DESTDIR)$(SHAREDIR)
+	${BSD_INSTALL_PROGRAM} spatch $(DESTDIR)$(SHAREDIR)
 	cat scripts/spatch.sh | sed "s|\.opt||" | sed "s|SHAREDIR|$(DESTDIR)$(SHAREDIR)|g" > $(DESTDIR)$(BINDIR)/spatch
 
 # user will use spatch.opt to run spatch.opt (native)
 install-opt: all.opt install-common
-	cp spatch.opt $(DESTDIR)$(SHAREDIR)
+	${BSD_INSTALL_PROGRAM} spatch.opt $(DESTDIR)$(SHAREDIR)
 	cat scripts/spatch.sh | sed "s|SHAREDIR|$(DESTDIR)$(SHAREDIR)|g" > $(DESTDIR)$(BINDIR)/spatch.opt
 
 uninstall:
