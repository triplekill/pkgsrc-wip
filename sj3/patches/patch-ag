$NetBSD$

--- src/sj3serv/priv.c.orig	2008-02-12 16:56:02.000000000 +0000
+++ src/sj3serv/priv.c
@@ -58,12 +58,12 @@ set_priv(const char *title)
 	    setresgid(pw->pw_gid, pw->pw_gid, pw->pw_gid) == -1 ||
 	    setresuid(pw->pw_uid, pw->pw_uid, pw->pw_uid) == -1
 #elif defined(HAVE_SETREUID) && !defined(BROKEN_SETREUID)
-	    setregid(pw->pw_gid, pw->pw_gid, pw->pw_gid) == -1 ||
-	    setreuid(pw->pw_uid, pw->pw_uid, pw->pw_uid) == -1
+	    setregid(pw->pw_gid, pw->pw_gid) == -1 ||
+	    setreuid(pw->pw_uid, pw->pw_uid) == -1
 #else
 # ifndef SETEUID_BREAKS_SETUID
 	    setegid(pw->pw_gid) == -1 ||
-	    seteuid(pw->pw_uid) == -1
+	    seteuid(pw->pw_uid) == -1 ||
 # endif
 	    setgid(pw->pw_gid) == -1 ||
 	    setuid(pw->pw_uid) == -1
