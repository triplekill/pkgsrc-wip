$NetBSD$

--- base/profiler.cc.orig	2010-08-18 09:05:07.000000000 +0000
+++ base/profiler.cc
@@ -4,7 +4,7 @@
 
 #include "base/profiler.h"
 
-#if defined(USE_TCMALLOC) && defined(OS_LINUX)
+#if defined(USE_TCMALLOC) && defined(OS_POSIX) && !defined(OS_MACOSX)
 #include "third_party/tcmalloc/chromium/src/google/profiler.h"
 #endif
 
@@ -23,7 +23,7 @@ namespace base {
 void Profiler::StartRecording() {
 #ifdef QUANTIFY
   QuantifyStartRecordingData();
-#elif defined(USE_TCMALLOC) && defined(OS_LINUX)
+#elif defined(USE_TCMALLOC) && defined(OS_POSIX) && !defined(OS_MACOSX)
   ProfilerStart("chrome-profile");
 #endif
 }
@@ -31,13 +31,13 @@ void Profiler::StartRecording() {
 void Profiler::StopRecording() {
 #ifdef QUANTIFY
   QuantifyStopRecordingData();
-#elif defined(USE_TCMALLOC) && defined(OS_LINUX)
+#elif defined(USE_TCMALLOC) && defined(OS_POSIX) && !defined(OS_MACOSX)
   ProfilerStop();
 #endif
 }
 
 void Profiler::Flush() {
-#if defined(USE_TCMALLOC) && defined(OS_LINUX)
+#if defined(USE_TCMALLOC) && defined(OS_POSIX) && !defined(OS_MACOSX)
   ProfilerFlush();
 #endif
 }
