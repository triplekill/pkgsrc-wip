# $NetBSD: rc.subr,v 1.4 2003/07/06 20:40:34 grant Exp $
#
# Copyright (c) 1997-2002 The NetBSD Foundation, Inc.
# All rights reserved.
#
# This code is derived from software contributed to The NetBSD Foundation
# by Luke Mewburn.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#        This product includes software developed by the NetBSD
#        Foundation, Inc. and its contributors.
# 4. Neither the name of The NetBSD Foundation nor the names of its
#    contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
# ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
# TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
# PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
# BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
# CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
# SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
# INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
# CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
# ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
# POSSIBILITY OF SUCH DAMAGE.
#
# rc.subr
#	functions used by various rc scripts
#

#	global variables
#	----------------

_RCCMD_chown="/usr/sbin/chown"
_RCCMD_chroot="/usr/sbin/chroot"
_RCCMD_ci="/usr/bin/ci"
_RCCMD_co="/usr/bin/co"
_RCCMD_cp="/bin/cp"
_RCCMD_echo="echo"			# use sh builtin
_RCCMD_kill="/bin/kill"
_RCCMD_logger="/usr/bin/logger"
_RCCMD_mount="/sbin/mount"
_RCCMD_mv="/bin/mv"
_RCCMD_nice="/usr/bin/nice"
_RCCMD_ps="/bin/ps"
_RCCMD_rcs="/usr/bin/rcs"
_RCCMD_rm="/bin/rm"
_RCCMD_sh="/bin/sh"
_RCCMD_su="/usr/bin/su"
_RCCMD_systrace="/bin/systrace"
_RCCMD_whoami="/usr/bin/whoami"

_RCARG_psformat="-o pid,command"
_RCARG_ps="-ax"

_osname=$(uname -s)
case $_osname in
	SunOS)
		_RCCMD_chown="/bin/chown"
#		_RCCMD_ci="/usr/bin/ci"			# not in Solaris 9
#		_RCCMD_co="/usr/bin/co"			# not in Solaris 9
		_RCCMD_echo="/usr/ucb/echo"
#		_RCCMD_systrace="/bin/systrace"		# not in Solaris 9
		_RCCMD_whoami="/usr/ucb/whoami"
		_RCARG_psformat="-o pid,comm"
		_RCARG_ps="-ef"
		;;
	Linux)
		_RCCMD_chown="/bin/chown"
#		_RCCMD_ci="/usr/bin/ci"			# not in Slackware 8.1
#		_RCCMD_co="/usr/bin/co"			# not in Slackware 8.1
		_RCCMD_nice=$(which nice)
#		_RCCMD_rcs="/usr/bin/rcs"		# not in Slackware 8.1
#		_RCCMD_systrace="/bin/systrace"		# not in Slackware 8.1
		_RCARG_ps="ax"
		;;
esac

#
#	functions
#	---------

#
# checkyesno var
#	Test $1 variable, and warn if not set to YES or NO.
#	Return 0 if it's "yes" (et al), nonzero otherwise.
#
checkyesno()
{
	eval _value=\$${1}
	case $_value in

		#	"yes", "true", "on", or "1"
	[Yy][Ee][Ss]|[Tt][Rr][Uu][Ee]|[Oo][Nn]|1)
		return 0
		;;

		#	"no", "false", "off", or "0"
	[Nn][Oo]|[Ff][Aa][Ll][Ss][Ee]|[Oo][Ff][Ff]|0)
		return 1
		;;
	*)
		warn "\$${1} is not set properly - see rc.conf(5)."
		return 1
		;;
	esac
}

# reverse_list list
#	print the list in reverse order
#
reverse_list()
{
	_revlist=
	for _revfile; do
		_revlist="$_revfile $_revlist"
	done
