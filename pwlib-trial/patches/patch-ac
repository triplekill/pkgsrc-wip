$NetBSD$

--- make/common.mak.orig	Tue Jul 29 11:25:23 2003
+++ make/common.mak
@@ -273,11 +273,11 @@ SOURCES         := $(strip $(SOURCES))
 #
 $(OBJDIR)/%.o : %.cxx 
 	@if [ ! -d $(OBJDIR) ] ; then mkdir -p $(OBJDIR) ; fi
-	$(CPLUS) $(STDCCFLAGS) $(OPTCCFLAGS) $(CFLAGS) -x c++ -c $< -o $@
+	/usr/pkg/bin/libtool --tag=CXX $(CPLUS) $(STDCCFLAGS) $(OPTCCFLAGS) $(CFLAGS) -c $< -o $@
 
 $(OBJDIR)/%.o : %.c 
 	@if [ ! -d $(OBJDIR) ] ; then mkdir -p $(OBJDIR) ; fi
-	$(CC) $(STDCCFLAGS) $(OPTCCFLAGS) $(CFLAGS) -x c -c $< -o $@
+	/usr/pkg/bin/libtool --tag=CC $(CC) $(STDCCFLAGS) $(OPTCCFLAGS) $(CFLAGS) -c $< -o $@
 
 #
 # create list of object files 
@@ -300,12 +300,12 @@ DEPS	 := $(patsubst %.dep, $(DEPDIR)/%.d
 $(DEPDIR)/%.dep : %.cxx 
 	@if [ ! -d $(DEPDIR) ] ; then mkdir -p $(DEPDIR) ; fi
 	@printf %s $(OBJDIR) > $@
-	$(CPLUS) $(STDCCFLAGS) -M $< >> $@
+	/usr/pkg/bin/libtool --tag=CXX $(CPLUS) $(STDCCFLAGS) -M $< >> $@
 
 $(DEPDIR)/%.dep : %.c 
 	@if [ ! -d $(DEPDIR) ] ; then mkdir -p $(DEPDIR) ; fi
 	@printf %s $(OBJDIR) > $@
-	$(CC) $(STDCCFLAGS) -M $< >> $@
+	/usr/pkg/bin/libtool --tag=CC $(CC) $(STDCCFLAGS) -M $< >> $@
 
 #
 # add in good files to delete
@@ -344,7 +344,7 @@ ifeq ($(OSTYPE),beos)
 # directory
 	@if [ ! -L $(OBJDIR)/lib ] ; then cd $(OBJDIR); ln -s $(PW_LIBDIR) lib; fi
 endif
-	$(CPLUS) -o $@ $(CFLAGS) $(LDFLAGS) $(OBJS) $(LDLIBS) $(ENDLDLIBS) $(ENDLDFLAGS)
+	/usr/pkg/bin/libtool --tag=CXX $(CPLUS) -o $@ $(CFLAGS) $(LDFLAGS) $(OBJS) $(LDLIBS) $(ENDLDLIBS) $(ENDLDFLAGS)
 ifeq ($(OSTYPE),VxWorks)
 	$(LD)   --split-by-reloc 65535 -r   $(OBJS) -o $@ 
 endif
@@ -380,7 +380,7 @@ CLEAN_FILES += $(TARGET)
 ifndef INSTALL_OVERRIDE
 
 install:	$(TARGET)
-	$(INSTALL) $(TARGET) $(INSTALLBIN_DIR)
+	/usr/pkg/bin/libtool $(BSD_INSTALL_PROGRAM) $(TARGET) $(INSTALLBIN_DIR)
 endif
 
 # ifdef PROG
