# $NetBSD$
.include "../../wip/heirloom-common/Makefile.prog.common"

PKGNAME=	heirloom-libcommon-${HEIRLOOM_VER}
CATEGORIES=	devel

DEPENDS+=	heirloom-doc-${HEIRLOOM_VER}:../../wip/heirloom-doc

MAKE_FLAGS+=	SUBDIRS="libcommon"

INSTALLATION_DIRS+=	include/heirloom lib

HEADERS_DIR=	${PREFIX}/include/heirloom

HEADERS=	_alloca.h _malloc.h _utmpx.h alloca.h asciitype.h atoll.h \
		blank.h getdir.h iblok.h malloc.h mbtowi.h memalign.h \
		msgselect.h oblok.h pathconf.h pfmt.h regexp.h regexpr.h \
		sfile.h sigset.h utmpx.h

PLIST_SUBST+=	NO_ALLOCA=
.if ${OPSYS} == "Linux"
PLIST_SUBST+=	"NO_ALLOCA=@comment "
.endif

do-install:
.for i in ${HEADERS}
	if test -r ${WRKSRC}/libcommon/${i}; then \
	   ${INSTALL_DATA} ${WRKSRC}/libcommon/${i} ${DESTDIR}${HEADERS_DIR}; \
	fi
.endfor
	${INSTALL_DATA} ${WRKSRC}/libcommon/libcommon.a \
		${DESTDIR}${PREFIX}/lib/libheirloomcommon.a

.include "../../mk/bsd.pkg.mk"
