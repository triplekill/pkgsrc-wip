- Several cleanup.

- Test if it works properly.
