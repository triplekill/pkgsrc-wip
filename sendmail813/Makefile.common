# $NetBSD$
#
# Makefile fragment shared with libmilter
#

DISTNAME=	sendmail.${DIST_VERS}
CATEGORIES=	mail
MASTER_SITES=	ftp://ftp.sendmail.org/pub/sendmail/ \
		ftp://ftp.fu-berlin.de/pub/unix/mail/sendmail/ \
		ftp://ftp.ayamura.org/pub/sendmail/

MAINTAINER=	tech-pkg@NetBSD.org
HOMEPAGE=	http://www.sendmail.org/

LICENSE=	no-profit

DISTINFO_FILE?=	${.CURDIR}/../../wip/sendmail813/distinfo
FILESDIR?=	${.CURDIR}/../../wip/sendmail813/files
PATCHDIR?=	${.CURDIR}/../../wip/sendmail813/patches

DIST_VERS=	8.13.1

MAKE_ENV+=	BSD_BINOWN="${BINOWN}" BSD_BINGRP="${BINGRP}" \
		BSD_MANOWN="${MANOWN}" BSD_MANGRP="${MANGRP}" \
		BUILDLINK_DIR="${BUILDLINK_DIR}"
SITECONFIG=	${WRKSRC}/devtools/Site/site.config.m4

BUILD_DEFS+=    SMRSH_CMDDIR

WRKSRC=		${WRKDIR}/sendmail-${DIST_VERS}
USE_BUILDLINK3=	YES
USE_GNU_TOOLS+=	m4
MAKE_ENV+=	M4="${M4}"

.include "../../mk/bsd.prefs.mk"

PKG_OPTIONS.sendmail?=	inet6 tcpwrappers

.include "options.mk"

make-sendmail-siteconfig:
	@${CP} ${FILESDIR}/site.config.m4 ${SITECONFIG}
	@${CHMOD} +w ${SITECONFIG}

.if !empty(PKG_OPTIONS:Minet6)
	@${CAT} ${FILESDIR}/site.config.m4-v6 >>${SITECONFIG}
.if ${OPSYS} != "SunOS" && ${OPSYS} != "BSDOS"
	@${CAT} ${FILESDIR}/site.config.m4-v6-not-solaris >>${SITECONFIG}
.endif
.endif

.if ${OPSYS} == "SunOS"
	@${CAT} ${FILESDIR}/site.config.m4-solaris >>${SITECONFIG}
.endif

.if ${OPSYS} == "Linux"
	@${CAT} ${FILESDIR}/site.config.m4-linux >>${SITECONFIG}
.endif

	@${CAT} ${FILESDIR}/site.config.m4-milter >>${SITECONFIG}
