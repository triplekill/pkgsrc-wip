# $NetBSD$
#

DISTNAME=	esmtp-0.5.1
CATEGORIES=	mail
MASTER_SITES=	${MASTER_SITE_SOURCEFORGE:=esmtp/}
EXTRACT_SUFX=	.tar.bz2

MAINTAINER=	lems@gmx.net
HOMEPAGE=	http://esmtp.sourceforge.net/
COMMENT=	Relay-only Mail Transfer Agent with sendmail-compatible syntax

BUILD_DEPENDS+=		bison-[0-9]*:../../devel/bison

GNU_CONFIGURE=		yes
USE_PKGINSTALL=		yes
PTHREAD_OPTS+=		require

CONFIGURE_ARGS+=	--sysconfdir=${PKG_SYSCONFDIR}

SUBST_CLASSES+=	paths
SUBST_MESSAGE.paths=	"Fixing hardcoded paths."
SUBST_STAGE.paths=	pre-configure
SUBST_FILES.paths=	sample.esmtprc
SUBST_FILES.paths+=	esmtprc.5
SUBST_SED.paths=	-e 's,/usr/bin,${PREFIX}/bin,g'

PKG_SYSCONFSUBDIR=	esmtp

EGDIR=			${PREFIX}/share/examples/esmtp
CONF_FILES=		${EGDIR}/sample.esmtprc \
			${PKG_SYSCONFDIR}/sample-esmtprc
post-install:
	${INSTALL_DATA_DIR} ${EGDIR}
	${INSTALL_DATA} ${WRKSRC}/sample.esmtprc ${EGDIR}

.include "../../mail/libesmtp/buildlink3.mk"
.include "../../security/openssl/buildlink3.mk"
.include "../../mk/pthread.buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
