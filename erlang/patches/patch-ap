$NetBSD: patch-ap,v 1.1 2009/12/15 12:09:20 asau Exp $

--- erts/emulator/hipe/hipe_x86.c.orig	2009-03-12 14:16:21.000000000 +0200
+++ erts/emulator/hipe/hipe_x86.c	2010-02-24 14:42:23.000000000 +0200
@@ -131,8 +131,10 @@
     map_start = mmap(map_hint, map_bytes,
 		     PROT_EXEC|PROT_READ|PROT_WRITE,
 		     MAP_PRIVATE|MAP_ANONYMOUS
-#ifdef __x86_64__
+#if defined(__x86_64__) && defined(MAP_32BIT) && !defined(MMAP_MAP_FIXED)
 		     |MAP_32BIT
+#elif defined(MMAP_MAP_FIXED)
+		     | MAP_FIXED
 #endif
 		     ,
 		     -1, 0);
