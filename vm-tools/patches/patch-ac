$NetBSD$

--- xenctld/ctrl.c.orig	2005-07-07 18:18:05.000000000 +0200
+++ xenctld/ctrl.c	2005-10-01 02:28:35.000000000 +0200
@@ -26,11 +26,19 @@
 #include <unistd.h>
 #include <malloc.h>
 #include <stdio.h>
+#include <string.h>
 
 #include "libxc.h"
 
+#ifdef __linux__
 #include <xen/linux/privcmd.h>
 #include <asm/page.h>
+#else
+/* XXX fixme, I've just hardcoded it from i386/vmparam.h */
+#define PAGE_SIZE (1 << 12)
+#include <xen/xenio.h>
+#include <machine/asm.h>
+#endif
 
 #include "log.h"
 #include "ctrl.h"
@@ -60,8 +68,11 @@
 	dom->cc.port.remote = 1;
 
 	if (dom->domid == 0) {
+#ifdef __linux__
 		int fd = open("/proc/xen/privcmd", O_RDWR);
-
+#else
+		int fd = open("/kern/xen/privcmd", O_RDWR);
+#endif
 		if (fd == -1) {
 			log(LOG_ERR, "open(/proc/xen/privcmd) failed: %m");
 			goto out;
