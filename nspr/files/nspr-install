#!/bin/sh
#
# $NetBSD$
#
# this script takes care of installing the nspr package, and is based on
# the moz-install script found in pkgsrc/www/mozilla/
#

# generate the PLIST that will be installed
# use a trap to ensure that the TMP_PLIST is removed if something goes wrong
#
TMP_PLIST=${WRKDIR}/TMP_PLIST.$$
trap "${RM} -f ${TMP_PLIST}" 1 2 15
${SED} -e "s/\${SO_SUFFIX}/${SO_SUFFIX}/" < ${PLIST_SRC} > ${TMP_PLIST}

# make directories to install the includes
${BSD_INSTALL_DATA_DIR} ${PREFIX}/include/nspr
for dir in md obsolete private ; do
	${BSD_INSTALL_DATA_DIR} ${PREFIX}/include/nspr/$dir
done

# install the includes
for i in `${EGREP} ^include/nspr ${TMP_PLIST}` ; do
	${BSD_INSTALL_DATA} ${WRKSRC}/dist/$i ${PREFIX}/$i
done

# install the libraries
for i in `${EGREP} ^lib/ ${TMP_PLIST}` ; do
	src=`echo $i | ${SED} -e "s@lib@dist/lib@"`;
	${NSPR_INSTALL_LIB} ${WRKSRC}/${src} ${PREFIX}/$i
done

# install the nspr-config script
${BSD_INSTALL_SCRIPT} ${WRKSRC}/config/nspr-config ${PREFIX}/bin
