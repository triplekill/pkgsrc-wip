$NetBSD$

--- client/File.h.orig	2006-05-27 19:14:28.000000000 +0200
+++ client/File.h
@@ -337,7 +337,7 @@ public:
 	}
 
 	virtual size_t flush() throw(Exception) {
-		if(fsync(h) == -1)
+		if (h != -1) if(fsync(h) == -1)
 			throw FileException(Util::translateError(errno));
 		return 0;
 	}
