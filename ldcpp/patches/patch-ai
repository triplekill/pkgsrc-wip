$NetBSD$

--- client/File.h.orig	2006-06-28 05:34:55.000000000 +0200
+++ client/File.h
@@ -339,7 +339,7 @@ public:
 	}
 
 	virtual size_t flush() throw(Exception) {
-		if(fsync(h) == -1)
+		if (h != -1) if(fsync(h) == -1)
 			throw FileException(Util::translateError(errno), filename);
 		return 0;
 	}
