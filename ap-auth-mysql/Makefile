# $NetBSD$
#

DISTNAME=		libapache-mod-auth-mysql_4.1.7
PKGNAME=		${DISTNAME:S/libapache-mod/ap/:S/_/-/}
WRKSRC=			${WRKDIR}/${DISTNAME:S/_/-/}
CATEGORIES=		www
MASTER_SITES=		${MASTER_SITE_DEBIAN:=pool/main/liba/libapache-mod-auth-mysql/}

MAINTAINER=		cube@NetBSD.org
HOMEPAGE=		http://packages.debian.org/unstable/web/libapache-mod-auth-mysql.html
COMMENT=		Module to allow Apache authentication against a MySQL database.

CONFLICTS+=		ap2-auth-mysql-*

USE_BUILDLINK2=		yes
GNU_CONFIGURE=		yes

CONFIGURE_ARGS+=	--with-mysql-includes=${BUILDLINK_PREFIX.mysql-client}/include/mysql	\
			--with-mysql-libs=${BUILDLINK_PREFIX.mysql-client}/lib/mysql
CPPFLAGS+=		-I${BUILDLINK_PREFIX.mysql-client}/include/mysql
LDFLAGS+=		-lmysqlclient -L${BUILDLINK_PREFIX.mysql-client}/lib/mysql		\
			-Wl,${RPATH_FLAG} -Wl,${BUILDLINK_PREFIX.mysql-client}/lib/mysql

APACHE_MODULE_NAME=	mod_auth_mysql.so

post-install:
	${INSTALL_DATA_DIR} ${PREFIX}/share/doc/mod_auth_mysql
	${INSTALL_DATA} ${WRKSRC}/DIRECTIVES ${PREFIX}/share/doc/mod_auth_mysql
	${INSTALL_DATA} ${WRKSRC}/USAGE ${PREFIX}/share/doc/mod_auth_mysql

.include "../../databases/mysql-client/buildlink2.mk"
.include "../../www/apache/module.mk"

.include "../../mk/bsd.pkg.mk"
