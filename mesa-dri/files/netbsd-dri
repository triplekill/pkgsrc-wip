# Configuration for netbsd-dri: NetBSD DRI hardware drivers

include $(TOP)/configs/netbsd

CONFIG_NAME = netbsd-dri

# Compiler and flags
#CC = gcc
#CXX = g++
WARN_FLAGS = -Wall
OPT_FLAGS = -O

#EXPAT_INCLUDES = -I/usr/local/include
#X11_INCLUDES = -I/usr/X11R6/include
X11_INCLUDES = -I${X11PREFIX}/include
DEFINES = -DPTHREADS -DUSE_EXTERNAL_DXTN_LIB=1 -DIN_DRI_DRIVER \
	-DGLX_DIRECT_RENDERING -DGLX_INDIRECT_RENDERING \
	-DHAVE_ALIAS

#CFLAGS = $(WARN_FLAGS) $(OPT_FLAGS) $(PIC_FLAGS) -Wmissing-prototypes -std=c99 -Wundef -ffast-math \
#      $(ASM_FLAGS) $(X11_INCLUDES) $(DEFINES)
CFLAGS += -O2 -fPIC -DUSE_XSHM -DHZ=100 $(DEFINES)
CXXFLAGS += -O2 -fPIC $(DEFINES)

#CXXFLAGS = $(WARN_FLAGS) $(OPT_FLAGS) $(PIC_FLAGS) $(DEFINES) -Wall -ansi -pedantic $(ASM_FLAGS) $(X11_INCLUDES)

#
#ASM_SOURCES =

# Library/program dependencies
LIBDRM_CFLAGS = `pkg-config --cflags libdrm`
LIBDRM_LIB = `pkg-config --libs libdrm`
DRI_LIB_DEPS = -lm -lpthread -lexpat $(LIBDRM_LIB)

APP_LIB_DEPS = -L$(LIB_DIR) -L${PREFIX}/lib ${COMPILER_RPATH_FLAG}${PREFIX}/lib -L${X11PREFIX}/lib ${COMPLIER_RPATH_FLAG}{$X11PREFIX}/lib -lXext -lXmu -lXi -lX11 -lm -lpthread $(LIBDRM_LIB) -lXxf86vm

# Directories
SRC_DIRS = glx/x11 mesa glu glut/glx glw
DRIVER_DIRS = dri
PROGRAM_DIRS =
WINDOW_SYSTEM=dri

# ffb and gamma are missing because they have not been converted to use the new
# interface.
DRI_DIRS = r300 r200 radeon

INSTALL_DIR = ${PREFIX}
DRI_DRIVER_INSTALL_DIR = ${PREFIX}/lib/modules/dri
