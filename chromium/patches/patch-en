$NetBSD$

--- third_party/WebKit/WebCore/bindings/v8/V8Proxy.cpp.orig	2010-09-13 15:27:38.000000000 +0000
+++ third_party/WebKit/WebCore/bindings/v8/V8Proxy.cpp
@@ -877,7 +877,34 @@ int V8Proxy::contextDebugId(v8::Handle<v
     if (!context->GetData()->IsString())
         return -1;
     v8::String::AsciiValue ascii(context->GetData());
+#if defined(OS_NETBSD)
+    const char *s = *ascii;
+    const char *find = ",";
+    size_t flen, len = ascii.length();
+    char c, sc;
+    char *comma = (char *)s;
+
+    if ((c = *find++) != '\0') {
+        flen = strlen(find);
+        do {
+            do {
+                if (len-- < 1 || (sc = *s++) == '\0') {
+                    comma = NULL;
+                    break;
+                }
+            } while (sc != c);
+            if (flen > len) {
+                comma = NULL;
+                break;
+            }
+        } while (strncmp(s, find, flen) != 0);
+        s--;
+    }
+    if (comma != NULL)
+        comma = (char *)s;
+#else
     char* comma = strnstr(*ascii, ",", ascii.length());
+#endif
     if (!comma)
         return -1;
     return atoi(comma + 1);
