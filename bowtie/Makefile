# $NetBSD$

###########################################################
#               Generated by fbsd2pkg                     #
###########################################################

###########################################################
# Unconverted and partially converted FreeBSD port syntax:

# .if ${ARCH} == i386
# MAKE_ENV+=	POPCNT_CAPABILITY=0
# .endif
# .include <bsd.port.post.mk>

PKGNAME=	bowtie-1.0.1
DISTNAME=	v1.0.1
CATEGORIES=	biology
MASTER_SITES=	http://github.com/BenLangmead/bowtie/archive/

MAINTAINER=	jwbacon@tds.net

COMMENT=	Ultrafast, memory-efficient short read aligner
LICENSE=	artistic

# Pessimistic assumption.  Test and change if possible.
MAKE_JOBS_SAFE=	no

# Just assuming C and C++: Adjust this!
USE_LANGUAGES=	c c++
USE_TOOLS+=	gmake perl:run pax
REPLACE_PERL=	scripts/*.pl

WRKSRC=		${WRKDIR}/bowtie-1.0.1

# Adapt REINPLACE commands to SUBST:
SUBST_CLASSES+=		lock_guard
SUBST_STAGE.lock_guard=	post-patch
SUBST_FILES.lock_guard=	hit.h log.h
SUBST_SED.lock_guard=	-e 's|lock_guard<MUTEX_T>|tthread::lock_guard<MUTEX_T>|g'
FETCH_USING=	curl

DATADIR=	${PREFIX}/share/bowtie

AUTO_MKDIRS=	yes

do-install:
	${INSTALL_PROGRAM} \
		${WRKSRC}/bowtie \
		${WRKSRC}/bowtie-build \
		${WRKSRC}/bowtie-inspect \
		${DESTDIR}${PREFIX}/bin
	${INSTALL_SCRIPT} \
		${WRKSRC}/scripts/*.sh \
		${WRKSRC}/scripts/*.pl \
		${FILESDIR}/bowtie-manual \
		${DESTDIR}${PREFIX}/bin
	${MKDIR} ${DESTDIR}${DATADIR}
	cd ${WRKSRC} && ${PAX} -wr genomes indexes reads \
		${DESTDIR}${DATADIR}
	cd ${WRKSRC}/doc && ${PAX} -wr * \
		${DESTDIR}${DOCSDIR}

.include "../../mk/bsd.pkg.mk"
