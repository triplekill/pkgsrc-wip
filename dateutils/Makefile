# $NetBSD: Makefile,v 1.2 2013/10/31 08:32:55 wiz Exp $

DISTNAME=	v0.3.1
PKGNAME=	${DISTNAME:S/^v/dateutils-/}
CATEGORIES=	time
MASTER_SITES=	http://github.com/hroptatyr/dateutils/archive/
DIST_SUBDIR=	dateutils

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	http://www.fresse.org/dateutils/
COMMENT=	Command line tools for working with dates
LICENSE=	modified-bsd

WRKSRC=		${WRKDIR}/${PKGNAME_NOREV}
GNU_CONFIGURE=	yes
USE_TOOLS+=	pkg-config automake autoreconf gmake makeinfo bison flex
USE_LIBTOOL=	yes

INFO_FILES=		yes
TEST_TARGET=		check
INCLUDEDIR=		include/${PKGBASE}
AUTO_MKDIRS=		YES

pre-configure:
	(cd ${WRKSRC}; autoreconf -i )

post-build:
	(cd ${WRKSRC}/lib; ${GMAKE})

post-install:
	(cd ${WRKSRC}/lib; \
	env DESTDIR=${DESTDIR} ${GMAKE} install-libLIBRARIES)
# To have the similar PLIST of previous version, installing headers.
.for i in \
	boops.h \
	date-core-strpf.h \
	date-core.h \
	dt-core-strpf.h \
	dt-core-tz-glue.h \
	dt-core.h \
	generics.h \
	gmtime.h \
	leaps.h \
	leapseconds.def \
	leapseconds.h \
	nifty.h \
	strops.h \
	time-core-strpf.h \
	time-core.h \
	token.h \
	tzmap.h \
	tzraw.h \
	version.h
	(cd ${WRKSRC}/lib; ${INSTALL_DATA} ${i} ${DESTDIR}${PREFIX}/${INCLUDEDIR})
.endfor

.include "../../devel/gperf/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
