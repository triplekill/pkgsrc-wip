$NetBSD$

--- kcontrol/infocenter/usbview/usbdevices.cpp.orig	2007-06-27 22:45:19.000000000 +1200
+++ kcontrol/infocenter/usbview/usbdevices.cpp
@@ -29,7 +29,7 @@
 
 #include <math.h>
 
-#ifdef Q_OS_FREEBSD
+#if defined(Q_OS_FREEBSD) || defined(Q_OS_NETBSD)
 #include <sys/ioctl.h>
 #include <sys/param.h>
 #endif
@@ -199,7 +199,7 @@ QString USBDevice::dump()
   if (!prname.isEmpty())
     pr += "<td>(" + prname +")</td>";
   r += i18n("<tr><td><i>Protocol</i></td>%1</tr>", pr);
-#ifndef Q_OS_FREEBSD
+#if !(defined(Q_OS_FREEBSD) || defined(Q_OS_NETBSD))
   r += ki18n("<tr><td><i>USB Version</i></td><td>%1.%2</td></tr>")
             .subs(_verMajor,0,16).subs(_verMinor,2,16,QChar::fromLatin1('0'))
             .toString();
@@ -223,7 +223,7 @@ QString USBDevice::dump()
 
   r += i18n("<tr><td><i>Speed</i></td><td>%1 Mbit/s</td></tr>", _speed);
   r += i18n("<tr><td><i>Channels</i></td><td>%1</td></tr>", _channels);
-#ifdef Q_OS_FREEBSD
+#if defined(Q_OS_FREEBSD) || defined(Q_OS_NETBSD)
 	if ( _power )
 		r += i18n("<tr><td><i>Power Consumption</i></td><td>%1 mA</td></tr>", _power);
 	else
@@ -254,7 +254,7 @@ QString USBDevice::dump()
 }
 
 
-#ifndef Q_OS_FREEBSD
+#if !(defined(Q_OS_FREEBSD) || defined(Q_OS_NETBSD))
 bool USBDevice::parse(const QString &fname)
 {
   _devices.clear();
@@ -350,7 +350,7 @@ void USBDevice::collectData( int fd, int
 	_channels     = di.udi_nports;
 
 	// determine the speed
-#if defined(__DragonFly__) || __FreeBSD_version > 490102
+#if defined(__DragonFly__) || (defined(Q_OS_FREEBSD) && __FreeBSD_version > 490102) || defined(Q_OS_NETBSD)
 	switch (di.udi_speed) {
 		case USB_SPEED_LOW:  _speed = 1.5;   break;
 		case USB_SPEED_FULL: _speed = 12.0;  break;
@@ -420,8 +420,10 @@ bool USBDevice::parse(const QString &fna
 				}
 			}
 			controller.close();
+#ifndef Q_OS_NETBSD
 		} else {
 			error = true;
+#endif
 		}
 		controller.setName( QString::fromLocal8Bit("/dev/usb%1").arg(i++) );
 	}
