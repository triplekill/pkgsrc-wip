$NetBSD: patch-an,v 1.1 2010/11/25 03:43:50 taca Exp $

Fix for CVE-2010-3710 (a part of http://secunia.com/advisories/41724/):

	http://svn.php.net/viewvc?view=revision&revision=303779

--- ext/filter/logical_filters.c.orig	2010-04-02 18:27:48.000000000 +0000
+++ ext/filter/logical_filters.c
@@ -531,6 +531,11 @@ void php_filter_validate_email(PHP_INPUT
 	int         matches;
 
 
+	/* The maximum length of an e-mail address is 320 octets, per RFC 2821. */
+	if (Z_STRLEN_P(value) > 320) {
+		RETURN_VALIDATION_FAILED
+	}
+
 	re = pcre_get_compiled_regex((char *)regexp, &pcre_extra, &preg_options TSRMLS_CC);
 	if (!re) {
 		RETURN_VALIDATION_FAILED
